

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<title>提交</title>
<link href="./css/mobile.css" rel="stylesheet" type="text/css">
<script language="javascript" type="text/javascript" src="./js/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="./js/common.js"></script>

</head>
<body>
<div class="proj_name">
测试</div>
<!-- include header -->

<div style="margin: 20px auto 15px auto; width: 95%; max-width: 800px; ">
	<div class="test_name">		
		<div style="float:left;">考生姓名：&nbsp; [ <b>123</b> ]</div>
		<div class="timetxt" style="float:right; color:#FF0000;font-weight:bold;">00:00:00</div>
		<div style="float:right;">剩余时间：</div>	
	</div>
</div>	


<div style="margin: 15px auto 15px auto; width: 95%; max-width: 800px; border: 1px solid rgb(199, 199, 199); background-color: rgb(255, 255, 255);border-radius: 2px;">
<table width="100%" border="0" cellspacing="1" cellpadding="6" align="center">
	<tbody><tr style="background-color:rgb(238, 238, 238); font-weight:bold;">
		<td nowrap="" align="center">内容</td>
		<!--<td nowrap align="center" width="12%">时长</td>-->
		<td nowrap="" align="center" width="12%">题量</td>
		<td nowrap="" align="center" width="12%">已答</td>
		<td nowrap="" align="center" width="12%">操作</td>
	</tr>
	</tbody><tbody class="tablelist">

	
<tr>
<td>通用胜任力测试</td>
<td nowrap="" align="center">40道</td>
<td nowrap="" align="center">40道</td>
<td nowrap="" align="center"><span title="该测试已完成，且不能修改" class="finish">不可修改</span></td>

	</tr></tbody>
</table>
</div>

<div class="btn_area" style="margin: 20px auto 0px auto; width: 95%; max-width: 800px; ">
	<div class="btn" id="btn_sub" style="width:100%;">我要交卷</div>
</div>




<script>
	//点击提交
	$("#btn_sub").click(function(){	
		var msg = "您真的要交卷吗，请确认？";
		var test_null_count = 0;
		if(test_null_count > 0){
			msg = '您还有 ' + test_null_count + ' 个科目没有作答，您真的要交卷吗？';
		}
		//第一次确认
		if (confirm(msg)==true){
			//第二次确认
			if(confirm('请再确认一次！')==true){
				location.href = './提交成功.html';
			}
		}		
	});
	//点击作答
	$(".start").click(function(){	
		var testid = $(this).attr("testid");
		location.href = '/ques/view/'+testid;
	});
</script>

<!--- 计时器 Begin -->
<script>
	//问题：微测计时器是采用JavaScript实现，当考生离开作答网页时，计时器被挂起，再次进入时才继续计时，导致计时慢了
	//思路：由于本机时间（设备时间）是稳定的，可借用手机设备的时间来修正计时器的误差

	//剩余时长 = 总时长 - 已用时长 + 前后端误差
	//剩余时长 = 总时长 - ( 考生设备当前时间 - 考生开始时间 ) + (考生设备端进入本页的时间 - 服务器端进入本页的时间)
	//left_time = time_length - (time_curr_c - begin_time) + (time_into_c - time_into_s)

	//得到设备当前时间
	function get_time_curr_c(){
		var curr_date = new Date();
		var curr_time = curr_date.getTime()/1000;  
		curr_time = Math.round(curr_time);
		return curr_time;
	}
	var time_curr_c = get_time_curr_c();
	var time_into_c = get_time_curr_c();

	//得到考生登录时间和总时长
		var time_length = 1200;
	var begin_time = 1524532378;
	var time_into_s = 1524532517;
	var time_c_s = time_into_c - time_into_s;		//前后端校时误差

	var left_time = time_length - (time_curr_c - begin_time) + time_c_s;

	//计时器显示
	var c=left_time;

	var t;
	function formatTime(second){
		var hour=Math.floor(second/60/60);
		var min=Math.floor(second/60)%60;
		var sec=second%60;
		if(hour<10){ hour="0"+hour;}
		if(min<10){ min="0"+min;}
		if(sec<10){ sec="0"+sec;}		
		return hour+":"+min+":"+sec;
	}
	//Load时就调用该函数
	function timedCount(){		
		if(c>0){
			c=c-1;
			t=setTimeout("timedCount()",1000);

			time_curr_c = get_time_curr_c();
			left_time = time_length - (time_curr_c - begin_time) + time_c_s;
			c = left_time;

			$(".timetxt").html(formatTime(c));

		}else{
			alert("时间已到，系统将自动交卷！");
			location.href = '/task/submit';
		}
		//$(".timetxt").html(formatTime(c));
	}	 
	window.load=timedCount(); 	
</script>
</body></html>